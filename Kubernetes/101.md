# OVERVIEW

## What is Kubernetes (k8s)?

Open-source container orchestration tool designed to automate, deploying, scaling, and operating containerized applications  

Allows organizations to increase their velocity by releasing and recovering faster  

**-Kubernetes is a distributed system**  
**-Machines may be physical, virtual, on-prem, or in the cloud**  
**-Schedules containers on machines**  
**-Moves containers as machines are added/removed**  
**-Can use different container runtimes**  
**-Modular, extensible design**  

**USAGE:**  
Declarative Configuration  
Deploy Containers  
Wire Up Networking  
Scale and Expose Services  

**OPERATIONS:**  
Automaticall Recover From Machine Failures  
Built-in Support For Machine Maintenance  
Join Clusters With Federation  

**FEATURES:**  
Automated deployment rollout and rollback  
Seamless horizontal scaling  
Secret management  
Service discovery and load balancing  
Linux and Windows container support  
Simple log collection  
Stateful application support  
Persistent volume management  
CPU and memory quotas  
Batch job processing  
Role-based access control  

## Kubernetes Architecture  

-Cluster referes to all of the machines collectively and can be thought of as the entire running system  
-**Nodes** are the machines in the cluster  
-Nodes are categorized as **workers** or **masters**  
-**Worker** nodes include software to run containers managed by the Kubernetes control plane  
-**Master** nodes run the control plane  
-The **control plane** is a set of APIs and software that Kubernetes users interact with  
-The APIs and software are referred to as **master components**  

**SCHEDULING:**  
-Control plane schedules containers onto nodes  
-Scheduling decisions consider required CPU and other factors  
-Scheduling referes to the decision process of placing containers onto node  

**Kubernetes PODs:**  
-Groups of containers  
-Pods are the smallest building block in Kubernetes  
-More complex and useful abstractions built on top of Pods  

**Kubernetes Services:**  
-Services define networking rules for exposing groups of Pods
a.)To other Pods  
b.)To the public Internet  

**Kubernetes Deployments:**  
-Manage deploying configuration changes to running Pods  
-Horizontal scaling  

**SUMMARY:**  
-Kubernetes is a container orchestration tool.  
-A group of Nodes form a Kubernetes Cluster.  
-Kubernetes runs containers in groups called Pods.  
-Kubernetes Services expose Pods to the Cluster and to the public internet.  
-Kubernetes Deployments controll rollout and rollback of Pods.  


# INTERACTING

## The Kubernetes API Server

**Modify cluster state information by sending requests to the Kubernetes API Server**  
**The API Server is a master component that acts as the frontend for the cluster**  

### Method1:

**REST API:**  
It is possible but not common to work directly with the API server  
You might need to if there is no Kubernetes client library for your programming language  

### Method2:

**Client Libraries:**
Handles authenticating and managing individual REST API requests and responses  
Kubernetes maintains official client libraries  
Community-maintained libraries when no official library exists  

### Method3:

**kubectl**  
Issue high-level commands that are translated into REST API calls  
Works with local and remote clusters  
Manages all different types of Kubernetes resources, and provides debugging and introspection features  

### Examples:

-**kubectl create** to create resources (Pods, Services, etc.)  
-**kubectl delete** to delete resources  
-**kubectl get** to get list of resources of a given type  
-**kubectl describe** to print detailed info about a resource(s)  
-**kubectl logs** to print container logs  

### Method4:

Web Dashboard

## What are PODs?

**Basic building block in Kubernetes**  
**One or more containers in a Pod**  
**Pod containers all share a container network**  
**One IP address per Pod**  

### What is in a Pod Declaration:

-Container image  
-Container ports  
-Container restart policy  
-Resource limits  

### Manifest Files  

-Declare desired properties  
-Manifests can describe all kinds of resource  
-The **spec** contains resource-specific properties  

### Manifests in Action  

-**kubectl create** sends manifest to Kubernetes API Server  
-API Server does the following for manifests
a.) Select a node with sufficient resources  
b.) Schedule Pod onto node  
c.) Node pulls Pod's container image  
d.) Starts Pod's container

### Why Use Manifests?

-Can check into source control  
-Easy to share  
-Easier to work with  

### POD DEMO:

<pre><font color="#8AE234"><b>vagrant@kiamol</b></font>:<font color="#729FCF"><b>/kiamol/ch01</b></font>$ kubectl get pods
No resources found in default namespace.
<font color="#8AE234"><b>vagrant@kiamol</b></font>:<font color="#729FCF"><b>/kiamol/ch01</b></font>$ kubectl create -f 1.1-basic_pod.yaml 
pod/mypod created
<font color="#8AE234"><b>vagrant@kiamol</b></font>:<font color="#729FCF"><b>/kiamol/ch01</b></font>$ kubectl get pods
NAME    READY   STATUS    RESTARTS   AGE
mypod   1/1     Running   0          14s
<font color="#8AE234"><b>vagrant@kiamol</b></font>:<font color="#729FCF"><b>/kiamol/ch01</b></font>$ more 1.1-basic_pod.yaml 
apiVersion: v1
kind: Pod
metadata:
  name: mypod
spec:
  containers:
  - name: mycontainer
    image: nginx:latest
<font color="#8AE234"><b>vagrant@kiamol</b></font>:<font color="#729FCF"><b>/kiamol/ch01</b></font>$ kubectl describe pod mypod
Name:         mypod
Namespace:    default
Priority:     0
Node:         kiamol-control-plane/172.18.0.2
Start Time:   Thu, 20 May 2021 13:24:33 +0000
Labels:       &lt;none&gt;
Annotations:  &lt;none&gt;
Status:       Running
IP:           10.244.0.5
IPs:
  IP:  10.244.0.5
Containers:
  mycontainer:
    Container ID:   containerd://0f6ede457a46743a3a664d5895601b5e8d729cf759d30416405a92165fbc26d5
    Image:          nginx:latest
    Image ID:       docker.io/library/nginx@sha256:df13abe416e37eb3db4722840dd479b00ba193ac6606e7902331dcea50f4f1f2
    Port:           &lt;none&gt;
    Host Port:      &lt;none&gt;
    State:          Running
      Started:      Thu, 20 May 2021 13:24:45 +0000
    Ready:          True
    Restart Count:  0
    Environment:    &lt;none&gt;
    Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from default-token-j6r7p (ro)
Conditions:
  Type              Status
  Initialized       True 
  Ready             True 
  ContainersReady   True 
  PodScheduled      True 
Volumes:
  default-token-j6r7p:
    Type:        Secret (a volume populated by a Secret)
    SecretName:  default-token-j6r7p
    Optional:    false
QoS Class:       BestEffort
Node-Selectors:  &lt;none&gt;
Tolerations:     node.kubernetes.io/not-ready:NoExecute op=Exists for 300s
                 node.kubernetes.io/unreachable:NoExecute op=Exists for 300s
Events:
  Type    Reason     Age   From               Message
  ----    ------     ----  ----               -------
  Normal  Scheduled  50s   default-scheduler  Successfully assigned default/mypod to kiamol-control-plane
  Normal  Pulling    49s   kubelet            Pulling image &quot;nginx:latest&quot;
  Normal  Pulled     38s   kubelet            Successfully pulled image &quot;nginx:latest&quot; in 11.346307579s
  Normal  Created    38s   kubelet            Created container mycontainer
  Normal  Started    38s   kubelet            Started container mycontainer
<font color="#8AE234"><b>vagrant@kiamol</b></font>:<font color="#729FCF"><b>/kiamol/ch01</b></font>$ 

</pre>  




